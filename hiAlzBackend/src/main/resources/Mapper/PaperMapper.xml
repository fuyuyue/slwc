<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.slwc.dao.PaperMapper">
    <resultMap id="PaperResultMap" type="com.slwc.vo.PaperVo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
    </sql>

    <select id="getPaperInfoList" resultType="com.slwc.entity.PaperEntity" parameterType="java.lang.String">
        SELECT title, author, journal_title as journalTitle, journal_no as journalNo, publish_time as publishTime,
        user_name as userName, page_no as pageNo
        FROM helloAlz.paper where user_name = #{0};
    </select>

    <select id="getPaperInfo" resultType="com.slwc.vo.PaperVo">
        SELECT title, author, journal_title as journalTitle, journal_no as journalNo, publish_time as publishTime,
        user_name as userName, page_no as pageNo
        FROM helloAlz.paper where title = #{0};
    </select>

    <insert id="insertPaperInfo" parameterType="com.slwc.vo.PaperVo">
        insert into helloAlz.paper (title, author, journal_title, journal_no, publish_time, page_no, user_name)
        values (#{title}, #{author}, #{journalTitle}, #{journalNo}, #{publishTime}, #{pageNo}, #{userName});
    </insert>

    <update id="updatePaperInfo" parameterType="com.slwc.vo.PaperVo">
        update helloAlz.paper set author=#{author}, journal_title=#{journalTitle}, journal_no=#{journalNo},
        publish_time=#{publishTime}, page_no=#{pageNo} where title=#{title}
    </update>

    <delete id="deletePaperInfo" parameterType="java.lang.String">
        delete from helloAlz.paper where title=#{0}
    </delete>

    <select id="getAllStudentsPaperInfo" resultType="com.slwc.vo.PaperVo">
        SELECT title, author, journal_title as journalTitle, journal_no as journalNo, publish_time as publishTime,
        pu.user_name as userName, page_no as pageNo, file_path as filesPath
        FROM
        (select * from helloAlz.paper p where p.user_name in
        (select user_name from helloAlz.userinfo u
        where u.role='学生')) as pu
        left join
        helloAlz.fileInfo f
        on f.user_name=pu.user_name and f.paper_title=pu.title
    </select>
</mapper>